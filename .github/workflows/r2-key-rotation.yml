name: R2 Key Rotation (Disabled)

# DISABLED: Cloudflare does not provide a public API to create permanent R2 tokens.
# The /accounts/{id}/r2/credentials endpoint does not exist.
# R2 tokens must be rotated manually via the Cloudflare dashboard.
#
# TODO: Implement using Cloudflare's general API tokens endpoint (/accounts/{id}/tokens)
# with R2 permission policies. See: https://developers.cloudflare.com/fundamentals/api/how-to/create-via-api/
#
# Manual rotation steps:
# 1. Go to Cloudflare Dashboard > R2 > Overview > Manage R2 API Tokens
# 2. Create a new token with read/write permissions
# 3. Update GitHub Secrets: REACH_R2_ACCESS_KEY and REACH_R2_SECRET_KEY
# 4. Delete the old token from Cloudflare dashboard
# 5. Restart Reach server to use new credentials

on:
  workflow_dispatch:
    inputs:
      acknowledge:
        description: 'This workflow is disabled - see comments for manual steps'
        required: false
        default: 'understood'
        type: choice
        options:
          - 'understood'

jobs:
  disabled-notice:
    runs-on: ubuntu-latest
    steps:
      - name: R2 Key Rotation Disabled
        run: |
          echo "## ⚠️ R2 Key Rotation Disabled" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "Automated R2 key rotation is **disabled** because Cloudflare does not provide" >> $GITHUB_STEP_SUMMARY
          echo "a public API to create permanent R2 tokens programmatically." >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### Manual Rotation Steps" >> $GITHUB_STEP_SUMMARY
          echo "1. Go to **Cloudflare Dashboard > R2 > Overview > Manage R2 API Tokens**" >> $GITHUB_STEP_SUMMARY
          echo "2. Create a new token with read/write permissions" >> $GITHUB_STEP_SUMMARY
          echo "3. Update GitHub Secrets:" >> $GITHUB_STEP_SUMMARY
          echo "   - \`REACH_R2_ACCESS_KEY\`" >> $GITHUB_STEP_SUMMARY
          echo "   - \`REACH_R2_SECRET_KEY\`" >> $GITHUB_STEP_SUMMARY
          echo "4. Delete the old token from Cloudflare dashboard" >> $GITHUB_STEP_SUMMARY
          echo "5. Restart Reach server to use new credentials" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### Future Enhancement" >> $GITHUB_STEP_SUMMARY
          echo "TODO: Implement using Cloudflare's general API tokens endpoint" >> $GITHUB_STEP_SUMMARY
          echo "(\`/accounts/{id}/tokens\`) with R2 permission policies." >> $GITHUB_STEP_SUMMARY
